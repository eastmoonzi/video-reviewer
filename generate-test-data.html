<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è¯»å–Excelå¹¶ç”Ÿæˆæµ‹è¯•æ•°æ®</title>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        pre { background: #f5f5f5; padding: 10px; overflow: auto; max-height: 400px; font-size: 12px; }
        button { padding: 10px 20px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #2563eb; }
        h2 { color: #333; border-bottom: 2px solid #3b82f6; padding-bottom: 10px; }
    </style>
</head>
<body>
    <h1>ğŸ“Š Excel è¯»å–ä¸æµ‹è¯•æ•°æ®ç”Ÿæˆå·¥å…·</h1>
    
    <div class="section">
        <h2>1. è¯»å–ç°æœ‰ Excel æ–‡ä»¶</h2>
        <p>é€‰æ‹© example.xlsx æŸ¥çœ‹å…¶æ ¼å¼ï¼š</p>
        <input type="file" id="read-file" accept=".xlsx,.xls">
        <div id="read-output"></div>
    </div>
    
    <div class="section">
        <h2>2. ç”Ÿæˆæµ‹è¯•æ•°æ®</h2>
        <p>ç‚¹å‡»æŒ‰é’®ç”ŸæˆåŒ…å«å¤šç»„æ•°æ®çš„æµ‹è¯•Excelæ–‡ä»¶ï¼š</p>
        <button onclick="generateTestData()">ç”Ÿæˆæµ‹è¯•æ•°æ® (test-multi-groups.xlsx)</button>
    </div>

    <script>
        // è¯»å–Excelæ–‡ä»¶
        document.getElementById('read-file').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const workbook = XLSX.read(e.target.result, { type: 'array', raw: false });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const rows = XLSX.utils.sheet_to_json(firstSheet, { header: 1, raw: false, defval: '' });
                
                let html = `<h3>æ–‡ä»¶ç»“æ„ï¼š${rows.length} è¡Œï¼Œ${rows[0]?.length || 0} åˆ—</h3>`;
                
                rows.forEach((row, i) => {
                    html += `<div style="margin:10px 0; padding:10px; background:#f9f9f9; border-radius:5px;">`;
                    html += `<strong>ç¬¬ ${i + 1} è¡Œï¼š</strong><br>`;
                    row.forEach((cell, j) => {
                        const preview = cell ? cell.toString().substring(0, 200) : '(ç©º)';
                        html += `<div style="margin:5px 0;"><strong>åˆ—${j + 1}:</strong> ${preview}${cell && cell.length > 200 ? '...' : ''}</div>`;
                    });
                    html += `</div>`;
                });
                
                document.getElementById('read-output').innerHTML = html;
            };
            reader.readAsArrayBuffer(file);
        });

        // ç”Ÿæˆæµ‹è¯•æ•°æ®
        function generateTestData() {
            // æ¨¡æ‹Ÿæ•°æ® - 3ä¸ªè§†é¢‘ï¼Œæ¯ä¸ªè§†é¢‘æœ‰2-3ç»„æ•°æ®
            const testData = [
                // ç¬¬1è¡Œï¼šæµ‹è¯•è§†é¢‘1ï¼Œ3ç»„æ•°æ®
                [
                    "https://www.w3schools.com/html/mov_bbb.mp4",
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 3], text: "ã€æ•°æ®ç»„1ã€‘å¤§è±¡è§’è‰²å‡ºç°åœ¨ç”»é¢ä¸­å¤®", vis: "ä¸€åªç°è‰²çš„å¤§è±¡ç«™åœ¨ç»¿è‰²è‰åœ°ä¸Šï¼ŒèƒŒæ™¯æ˜¯è“å¤©ç™½äº‘", key_frame: [{ time: 1, desc: "å¤§è±¡æ­£é¢ç‰¹å†™" }] },
                            { time: [3, 7], text: "ã€æ•°æ®ç»„1ã€‘å…”å­å’Œå°é¸Ÿå¼€å§‹äº’åŠ¨", vis: "ç™½è‰²çš„å…”å­å’Œä¸€åªé»„è‰²å°é¸Ÿåœ¨è‰åœ°ä¸Šå¬‰æˆ", key_frame: [{ time: 5, desc: "å…”å­å’Œå°é¸Ÿäº’åŠ¨é•œå¤´" }] },
                            { time: [7, 10], text: "ã€æ•°æ®ç»„1ã€‘åœºæ™¯é€æ¸ç»“æŸ", vis: "æ‰€æœ‰åŠ¨ç‰©è§’è‰²æ¸æ¸è¿œå»", key_frame: [{ time: 9, desc: "ç»“æŸç”»é¢" }] }
                        ]
                    }),
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 5], text: "ã€æ•°æ®ç»„2ã€‘åŠ¨ç”»å¼€åœºï¼Œå±•ç¤ºæ£®æ—åœºæ™¯", vis: "èŒ‚å¯†çš„æ£®æ—ï¼Œé˜³å…‰é€è¿‡æ ‘å¶", key_frame: [{ time: 2, desc: "æ£®æ—å…¨æ™¯" }] },
                            { time: [5, 10], text: "ã€æ•°æ®ç»„2ã€‘åŠ¨ç‰©ä»¬èšé›†åœ¨ä¸€èµ·", vis: "å¤§è±¡ã€å…”å­ã€å°é¸Ÿç­‰åŠ¨ç‰©èšé›†åœ¨è‰åœ°ä¸Š", key_frame: [{ time: 8, desc: "åŠ¨ç‰©ç¾¤åƒ" }] }
                        ]
                    }),
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 4], text: "ã€æ•°æ®ç»„3ã€‘ç¬¬ä¸€å¹•ï¼šä»‹ç»ä¸»è§’", vis: "å¯çˆ±çš„å¡é€šåŠ¨ç‰©è§’è‰²å‡ºåœº", key_frame: [{ time: 2, desc: "ä¸»è§’äº®ç›¸" }] },
                            { time: [4, 7], text: "ã€æ•°æ®ç»„3ã€‘ç¬¬äºŒå¹•ï¼šæ•…äº‹å‘å±•", vis: "åŠ¨ç‰©ä»¬ä¹‹é—´çš„å‹è°Šäº’åŠ¨", key_frame: [{ time: 6, desc: "å‹è°Šåœºæ™¯" }] },
                            { time: [7, 10], text: "ã€æ•°æ®ç»„3ã€‘ç¬¬ä¸‰å¹•ï¼šç»“å±€", vis: "æ¸©é¦¨çš„ç»“å°¾ç”»é¢", key_frame: [{ time: 9, desc: "æ¸©é¦¨ç»“å±€" }] }
                        ]
                    })
                ],
                // ç¬¬2è¡Œï¼šæµ‹è¯•è§†é¢‘2ï¼Œ2ç»„æ•°æ®
                [
                    "https://www.w3schools.com/html/movie.mp4",
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 3], text: "ã€Aæ¨¡å‹ã€‘Bearè§’è‰²è‡ªæˆ‘ä»‹ç»", vis: "æ£•è‰²çš„ç†Šç«™åœ¨è‰åœ°ä¸Šï¼Œé¢å¸¦å¾®ç¬‘", key_frame: [{ time: 1.5, desc: "Bearæ­£é¢" }] },
                            { time: [3, 6], text: "ã€Aæ¨¡å‹ã€‘å±•ç¤ºBearçš„æ—¥å¸¸ç”Ÿæ´»", vis: "Bearåœ¨æ£®æ—ä¸­æ¼«æ­¥", key_frame: [{ time: 4.5, desc: "Bearè¡Œèµ°" }] }
                        ]
                    }),
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 2], text: "ã€Bæ¨¡å‹ã€‘ç‰‡å¤´LOGOå±•ç¤º", vis: "Big Buck Bunnyçš„åŠ¨ç”»LOGO", key_frame: [{ time: 1, desc: "LOGOç”»é¢" }] },
                            { time: [2, 4], text: "ã€Bæ¨¡å‹ã€‘ä¸»è§’Bearç™»åœº", vis: "Bearä»ç”»é¢å·¦ä¾§èµ°å…¥", key_frame: [{ time: 3, desc: "Bearå…¥åœº" }] },
                            { time: [4, 6], text: "ã€Bæ¨¡å‹ã€‘Bearåšè¡¨æƒ…", vis: "Bearå±•ç¤ºå„ç§å¯çˆ±è¡¨æƒ…", key_frame: [{ time: 5, desc: "Bearè¡¨æƒ…ç‰¹å†™" }] }
                        ]
                    })
                ],
                // ç¬¬3è¡Œï¼šæµ‹è¯•è§†é¢‘3ï¼Œ2ç»„æ•°æ®
                [
                    "https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm",
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 2.5], text: "ã€ç‰ˆæœ¬1ã€‘ç‰¹å†™å±•ç¤ºä¸€æœµç››å¼€çš„èŠ±", vis: "ç²‰è‰²èŠ±æœµç‰¹å†™ï¼ŒèŠ±ç“£å±‚æ¬¡åˆ†æ˜ï¼Œèœœèœ‚åœ¨é‡‡èœœ", key_frame: [{ time: 1, desc: "èŠ±æœµç‰¹å†™" }] },
                            { time: [2.5, 5], text: "ã€ç‰ˆæœ¬1ã€‘èœœèœ‚åœ¨èŠ±æœµä¸Šé‡‡é›†èŠ±èœœ", vis: "èœœèœ‚è½åœ¨èŠ±è•Šä¸Šï¼Œç¿…è†€éœ‡åŠ¨", key_frame: [{ time: 4, desc: "èœœèœ‚é‡‡èœœ" }] }
                        ]
                    }),
                    JSON.stringify({
                        segment_detail: [
                            { time: [0, 1.5], text: "ã€ç‰ˆæœ¬2ã€‘é•œå¤´æ¨è¿›ï¼Œå±•ç¤ºèŠ±æœµç»†èŠ‚", vis: "èŠ±æœµç”±è¿œåŠè¿‘ï¼Œå±•ç¤ºèŠ±ç“£çº¹ç†", key_frame: [{ time: 0.8, desc: "èŠ±æœµè¿œæ™¯" }] },
                            { time: [1.5, 3], text: "ã€ç‰ˆæœ¬2ã€‘è‡ªç„¶å…‰çº¿ä¸‹çš„èŠ±æœµ", vis: "é˜³å…‰ç…§å°„ä¸‹çš„èŠ±æœµï¼Œè‰²å½©é²œè‰³", key_frame: [{ time: 2, desc: "è‡ªç„¶å…‰èŠ±æœµ" }] },
                            { time: [3, 5], text: "ã€ç‰ˆæœ¬2ã€‘èœœèœ‚ä¸èŠ±æœµçš„äº’åŠ¨", vis: "èœœèœ‚å›´ç»•èŠ±æœµé£èˆ", key_frame: [{ time: 4, desc: "èœœèœ‚é£èˆ" }] }
                        ]
                    })
                ]
            ];

            // åˆ›å»ºå·¥ä½œç°¿
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(testData);
            
            // è®¾ç½®åˆ—å®½
            ws['!cols'] = [
                { wch: 60 },  // URLåˆ—
                { wch: 100 }, // æ•°æ®ç»„1
                { wch: 100 }, // æ•°æ®ç»„2
                { wch: 100 }  // æ•°æ®ç»„3
            ];
            
            XLSX.utils.book_append_sheet(wb, ws, 'TestData');
            
            // ä¸‹è½½æ–‡ä»¶
            XLSX.writeFile(wb, 'test-multi-groups.xlsx');
            
            alert('æµ‹è¯•æ–‡ä»¶ test-multi-groups.xlsx å·²ç”Ÿæˆï¼\n\nåŒ…å«ï¼š\n- 3ä¸ªè§†é¢‘\n- ç¬¬1ä¸ªè§†é¢‘æœ‰3ç»„æ•°æ®\n- ç¬¬2ã€3ä¸ªè§†é¢‘å„æœ‰2ç»„æ•°æ®\n\nè¯·åœ¨ä¸»ç¨‹åºä¸­å¯¼å…¥æµ‹è¯•ã€‚');
        }
    </script>
</body>
</html>